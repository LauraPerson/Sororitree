<div class="container-page">
  <div class="container-background" style="background-image: url(<%= image_path 'womem_handsup1.png' %>)">
  </div>
  <div class="container-posts">
    <div class="py-3 px-3">
      <h1> Sororitree Posts </h1>
    </div>

    <div class="cards-form">
      <%= simple_form_for @post, url: {controller: "posts", action: "create"} do |f| %>
        <%= f.input :content, label: false, placeholder: 'Nos conte sua história...', input_html: { class: 'card-form' } %>
        <%= f.association :theme, label: "Temática:", input_html: { class: 'card-form' } %>
        <%= f.button :submit, 'Compartilhe', class: 'btn-post' %>
      <% end %>
    </div>

    <div class="search-bar text-center mt-2 mb-5">
      <%= form_tag posts_path, method: :get do %>
        <%= text_field_tag :query, "", placeholder: "Insira um assunto", required: true %>
        <button class="btn-post-search">Filtre</button>
      <% end %>
    </div>

    <div>
      <% @posts.each do |post| %>
      <div class="posts-cards mt-4">
        <div class="d-flex justify-content-between">
          <div class="d-flex align-self-center">
            <div class="avatar-post mx-1 align-self-center" style="background-image: url('<%= image_path("Avatars/avatar_#{post.user.avatar.id}.png", crop: :fill) %>')"></div>
            <div class="post-name-avatar align-self-center"><p><%= post.user.nickname %></p></div>
          </div>
          <div class="font-theme">
            <p>Temática: <%= post.theme.title %></p>
          </div>
        </div>
        <div class="post-time d-flex text-left">
          <% time_min = (DateTime.now().to_time - post.created_at.to_time) / 60 %>
          <% if time_min < 60  %>
            <p>Postado: <%= time_min.round %> min</p>
          <% elsif time_min > 60 && time_min < 1440 %>
            <p>Postado: <%= (time_min/60).round %> h</p>
          <% else %>
            <p>Postado: <%= post.created_at.strftime("%d-%m-%Y") %></p>
          <% end %>
        </div>
        <p><%= post.content %></p>
      </div>
      <% end %>
    </div>
  </div>
</div>
